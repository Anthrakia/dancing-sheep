#summary The Client/Server Protocol

= Introduction =

The client and the server communicate with HTTP.  The server replies with XML structured data, images, and animations.

= On Install =

When the client is installed it generates a 8-byte random unique ID, written with hex digits, eg FDB1C06A94A0FC87.  This UID is passed to all subsequent queries.

= On Startup =

When the client starts up it makes a redirection query.  the resulting hostname is used for all subsequent non-redirection.  queries.  The redirection is cached.
{{{
http://community.sheepserver.net/query.php?q=redir&u=$ACCOUNT&p=$HASH&v=$VERSION&i=$UID
}}}
Where $ACCOUNT is the drupal login, $HASH is the md5 hash with salt, VERSION is the client version number, and UID was generated on install.
For example:
{{{
http://community.sheepserver.net/query.php?q=redir&u=spot&p=E42D7CD78F00B204E9800998ECF8427E&v=LNX_2.7b12&i=8D94A5E812F4D8E9
}}}
reply:
{{{
<query><redir host="http://v2d7c.sheepserver.net/"/></query>
}}}

= List Sheep =
To get a directory of current live sheep the client fetches:
{{{
$HOST/list?u=$UID&v=$VERSION
}}}
reply is gzipped XML:
{{{
<list gen="244" size="800 592" retry="600">
<sheep id="27045" type="0" state="done" time="1283912914" size="1688352" rating="102" first="27045" last="27045" url="http://v2d7c.sheepserver.net.nyud.net/gen/244/27045/sheep.avi"/>
...
</list>
}}}